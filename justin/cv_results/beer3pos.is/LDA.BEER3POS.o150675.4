bash: module: line 1: syntax error: unexpected end of file
bash: error importing function definition for `module'
4
./process.sh 400 BEER3POS
Data = Beer3 Positive
Cross-validation for K=400
Data shape (856, 1664)
K=400 Testing fold=0
K=400 Training fold=1
K=400 Training fold=2
K=400 Training fold=3
Run training gibbs (642, 1664)
CGS LDA initialising
.................................................................
Using Numba for LDA sampling
Preparing words
Preparing Z matrix
DONE
Sample 1   Log joint likelihood = -2452858.648 
Sample 2   Log joint likelihood = -1541651.618 
Sample 3   Log joint likelihood = -1148910.509 
Sample 4   Log joint likelihood = -1029893.429 
Sample 5   Log joint likelihood = -982410.056 
Sample 6   Log joint likelihood = -956011.652 
Sample 7   Log joint likelihood = -937716.472 
Sample 8   Log joint likelihood = -923396.603 
Sample 9   Log joint likelihood = -912657.154 
Sample 10   Log joint likelihood = -904547.257 
Sample 11   Log joint likelihood = -897715.848 
Sample 12   Log joint likelihood = -892209.623 
Sample 13   Log joint likelihood = -887601.780 
Sample 14   Log joint likelihood = -882974.937 
Sample 15   Log joint likelihood = -879465.740 
Sample 16   Log joint likelihood = -876444.217 
Sample 17   Log joint likelihood = -874321.456 
Sample 18   Log joint likelihood = -871356.563 
Sample 19   Log joint likelihood = -869108.446 
Sample 20   Log joint likelihood = -867298.373 
Sample 21   Log joint likelihood = -864127.958 
Sample 22   Log joint likelihood = -861838.625 
Sample 23   Log joint likelihood = -860444.027 
Sample 24   Log joint likelihood = -859228.033 
Sample 25   Log joint likelihood = -857670.711 
Sample 26   Log joint likelihood = -857563.645 
Sample 27   Log joint likelihood = -856085.049 
Sample 28   Log joint likelihood = -854967.370 
Sample 29   Log joint likelihood = -854114.269 
Sample 30   Log joint likelihood = -853333.099 
Sample 31   Log joint likelihood = -851566.624 
Sample 32   Log joint likelihood = -850868.602 
Sample 33   Log joint likelihood = -850283.371 
Sample 34   Log joint likelihood = -849573.734 
Sample 35   Log joint likelihood = -849822.100 
Sample 36   Log joint likelihood = -849412.619 
Sample 37   Log joint likelihood = -848124.542 
Sample 38   Log joint likelihood = -848087.072 
Sample 39   Log joint likelihood = -848122.590 
Sample 40   Log joint likelihood = -847543.515 
Sample 41   Log joint likelihood = -846937.806 
Sample 42   Log joint likelihood = -846202.934 
Sample 43   Log joint likelihood = -845064.652 
Sample 44   Log joint likelihood = -844408.065 
Sample 45   Log joint likelihood = -844637.779 
Sample 46   Log joint likelihood = -844575.929 
Sample 47   Log joint likelihood = -844045.692 
Sample 48   Log joint likelihood = -844309.678 
Sample 49   Log joint likelihood = -843256.508 
Sample 50   Log joint likelihood = -841865.260 
Run testing importance sampling (214, 1664)
topic_prior = [[ 0.34025709]
 [ 0.33609343]
 [ 0.33719873]
 [ 0.33958316]
 [ 0.33908997]
 [ 0.33998374]
 [ 0.33643788]
 [ 0.33678297]
 [ 0.34252421]
 [ 0.3410656 ]
 [ 0.33880101]
 [ 0.35489293]
 [ 0.34896823]
 [ 0.3383741 ]
 [ 0.34311843]
 [ 0.33914333]
 [ 0.33975364]
 [ 0.37762772]
 [ 0.33854743]
 [ 0.34472578]
 [ 0.33709923]
 [ 0.3381563 ]
 [ 0.33689945]
 [ 0.34118425]
 [ 0.341525  ]
 [ 0.33964794]
 [ 0.39232068]
 [ 0.3643581 ]
 [ 0.36018391]
 [ 0.39556386]
 [ 0.33574962]
 [ 0.43604744]
 [ 0.35268726]
 [ 0.34154186]
 [ 0.3546102 ]
 [ 0.33730225]
 [ 0.34599738]
 [ 0.3419599 ]
 [ 0.33821052]
 [ 0.33798026]
 [ 0.33967457]
 [ 0.33574962]
 [ 0.33609343]
 [ 0.3418471 ]
 [ 0.35532774]
 [ 0.34066653]
 [ 0.3402174 ]
 [ 0.34565987]
 [ 0.34820899]
 [ 0.339764  ]
 [ 0.35707171]
 [ 0.34557939]
 [ 0.33861072]
 [ 0.33574962]
 [ 0.33908695]
 [ 0.33782016]
 [ 0.34031029]
 [ 0.3373011 ]
 [ 0.33719848]
 [ 0.34201272]
 [ 0.35779254]
 [ 0.34616438]
 [ 0.36896274]
 [ 0.33834383]
 [ 0.33958226]
 [ 0.3390158 ]
 [ 0.34037553]
 [ 0.33679778]
 [ 0.33829654]
 [ 0.34120099]
 [ 0.33643788]
 [ 0.34525378]
 [ 0.33609343]
 [ 0.33840643]
 [ 0.3410423 ]
 [ 0.3391832 ]
 [ 0.33760697]
 [ 0.33782212]
 [ 0.33924496]
 [ 0.36204667]
 [ 0.33999578]
 [ 0.33945617]
 [ 0.33714354]
 [ 0.34318393]
 [ 0.35065881]
 [ 0.35560805]
 [ 0.34086766]
 [ 0.33789449]
 [ 0.34882334]
 [ 0.34010282]
 [ 0.33767975]
 [ 0.33816507]
 [ 0.33714196]
 [ 0.33998195]
 [ 0.33574962]
 [ 0.34214871]
 [ 0.33752639]
 [ 0.33782282]
 [ 0.34372553]
 [ 0.3377787 ]
 [ 0.34278039]
 [ 0.35336534]
 [ 0.36704389]
 [ 0.33906133]
 [ 0.35622032]
 [ 0.35675138]
 [ 0.34960956]
 [ 0.3411812 ]
 [ 0.33712871]
 [ 0.34532111]
 [ 0.33979135]
 [ 0.34259745]
 [ 0.34556241]
 [ 0.34124172]
 [ 0.33849182]
 [ 0.35220865]
 [ 0.33798212]
 [ 0.33574962]
 [ 0.34145281]
 [ 0.33678297]
 [ 0.33824348]
 [ 0.36943547]
 [ 0.33959665]
 [ 0.35018877]
 [ 0.36516353]
 [ 0.33787572]
 [ 0.37555136]
 [ 0.36211516]
 [ 0.34224173]
 [ 0.34084498]
 [ 0.34083875]
 [ 0.34230552]
 [ 0.33625351]
 [ 0.33818802]
 [ 0.33678297]
 [ 0.33865644]
 [ 0.33643788]
 [ 0.33880403]
 [ 0.3408212 ]
 [ 0.33609343]
 [ 0.33941729]
 [ 0.34235447]
 [ 0.3424934 ]
 [ 0.33859443]
 [ 0.33961105]
 [ 0.33749757]
 [ 0.33739193]
 [ 0.34187896]
 [ 0.34748107]
 [ 0.33574962]
 [ 0.36360428]
 [ 0.34235444]
 [ 0.33750954]
 [ 0.39564926]
 [ 0.33841657]
 [ 0.33765431]
 [ 0.34366323]
 [ 0.33883445]
 [ 0.33725107]
 [ 0.35119373]
 [ 0.33717223]
 [ 0.33643788]
 [ 0.33676275]
 [ 0.33847493]
 [ 0.34012474]
 [ 0.33833825]
 [ 0.3386624 ]
 [ 0.33609343]
 [ 0.33574962]
 [ 0.33775135]
 [ 0.3384617 ]
 [ 0.34271372]
 [ 0.33609343]
 [ 0.33838802]
 [ 0.386053  ]
 [ 0.35176097]
 [ 0.33919589]
 [ 0.34598426]
 [ 0.33858075]
 [ 0.3390438 ]
 [ 0.33888248]
 [ 0.33892919]
 [ 0.33609343]
 [ 0.33823625]
 [ 0.33725731]
 [ 0.33704374]
 [ 0.3365377 ]
 [ 0.34698035]
 [ 0.34184343]
 [ 0.33989959]
 [ 0.34541895]
 [ 0.33574962]
 [ 0.33925732]
 [ 0.33887037]
 [ 0.33962229]
 [ 0.3381424 ]
 [ 0.35801093]
 [ 0.33780353]
 [ 0.37156073]
 [ 0.33966971]
 [ 0.36140464]
 [ 0.33712244]
 [ 0.33845245]
 [ 0.33766484]
 [ 0.34319516]
 [ 0.34951468]
 [ 0.33721653]
 [ 0.34251126]
 [ 0.33882953]
 [ 0.33609343]
 [ 0.33878538]
 [ 0.34202552]
 [ 0.34088374]
 [ 0.33910226]
 [ 0.34137017]
 [ 0.34380202]
 [ 0.33609343]
 [ 0.33819293]
 [ 0.33609343]
 [ 0.34009393]
 [ 0.34126113]
 [ 0.33742945]
 [ 0.33574962]
 [ 0.34126426]
 [ 0.33950457]
 [ 0.33574962]
 [ 0.33609343]
 [ 0.34390747]
 [ 0.3442558 ]
 [ 0.35988475]
 [ 0.33690431]
 [ 0.33732221]
 [ 0.34956942]
 [ 0.34840896]
 [ 0.33919045]
 [ 0.34874559]
 [ 0.34468266]
 [ 0.33574962]
 [ 0.344344  ]
 [ 0.48739172]
 [ 0.3380856 ]
 [ 0.34448935]
 [ 0.34854904]
 [ 0.33678297]
 [ 0.35794338]
 [ 0.33609343]
 [ 0.34164097]
 [ 0.35122309]
 [ 0.34371049]
 [ 0.34165232]
 [ 0.33987175]
 [ 0.3383563 ]
 [ 0.3482901 ]
 [ 0.33914635]
 [ 0.33678297]
 [ 0.33723606]
 [ 0.34437428]
 [ 0.34538917]
 [ 0.33688298]
 [ 0.33609343]
 [ 0.33823255]
 [ 0.33574962]
 [ 0.34886828]
 [ 0.33897595]
 [ 0.42897124]
 [ 0.33915702]
 [ 0.33864726]
 [ 0.33870517]
 [ 0.34121181]
 [ 0.34090716]
 [ 0.33876559]
 [ 0.33953277]
 [ 0.34822557]
 [ 0.33936017]
 [ 0.33795273]
 [ 0.38827683]
 [ 0.33837255]
 [ 0.34259918]
 [ 0.35039759]
 [ 0.33784213]
 [ 0.3388484 ]
 [ 0.33867909]
 [ 0.34049058]
 [ 0.33727051]
 [ 0.33722044]
 [ 0.33643788]
 [ 0.33878064]
 [ 0.33920104]
 [ 0.33728398]
 [ 0.33902183]
 [ 0.33800603]
 [ 0.33993961]
 [ 0.33720944]
 [ 0.39718061]
 [ 0.33970663]
 [ 0.33886872]
 [ 0.44693013]
 [ 0.40538875]
 [ 0.33767247]
 [ 0.34137842]
 [ 0.33793297]
 [ 0.33835633]
 [ 0.33609343]
 [ 0.35775227]
 [ 0.33736768]
 [ 0.33574962]
 [ 0.33821471]
 [ 0.33686147]
 [ 0.33734571]
 [ 0.3387169 ]
 [ 0.35302891]
 [ 0.34294709]
 [ 0.34057991]
 [ 0.33864922]
 [ 0.33972224]
 [ 0.35716317]
 [ 0.33741181]
 [ 0.34100561]
 [ 0.34025393]
 [ 0.35188298]
 [ 0.33828941]
 [ 0.34335951]
 [ 0.34176215]
 [ 0.35893278]
 [ 0.3378154 ]
 [ 0.35257697]
 [ 0.33722044]
 [ 0.36086385]
 [ 0.34654733]
 [ 0.34130568]
 [ 0.33678297]
 [ 0.3436286 ]
 [ 0.33907687]
 [ 0.33619307]
 [ 0.34445808]
 [ 0.34776767]
 [ 0.3378618 ]
 [ 0.34026063]
 [ 0.33975874]
 [ 0.3494457 ]
 [ 0.34170221]
 [ 0.33609343]
 [ 0.33609343]
 [ 0.34711388]
 [ 0.34037264]
 [ 0.34020636]
 [ 0.33808687]
 [ 0.35169697]
 [ 0.33744671]
 [ 0.33948169]
 [ 0.33643788]
 [ 0.33774395]
 [ 0.33877197]
 [ 0.34329008]
 [ 0.3378986 ]
 [ 0.34008956]
 [ 0.33609343]
 [ 0.34031542]
 [ 0.33609343]
 [ 0.33818983]
 [ 0.33747509]
 [ 0.34316871]
 [ 0.33828269]
 [ 0.33741123]
 [ 0.33775105]
 [ 0.34946696]
 [ 0.33745303]
 [ 0.33986508]
 [ 0.33923895]
 [ 0.33832898]
 [ 0.3387123 ]
 [ 0.34192949]
 [ 0.34122534]
 [ 0.33745035]
 [ 0.33736995]
 [ 0.34256533]
 [ 0.33905077]
 [ 0.34024549]
 [ 0.33913166]
 [ 0.33914545]
 [ 0.34346025]
 [ 0.34044825]
 [ 0.33609343]
 [ 0.34234654]
 [ 0.34111999]
 [ 0.34316193]
 [ 0.33678297]
 [ 0.3969389 ]
 [ 0.40438031]
 [ 0.36275777]
 [ 0.34032159]
 [ 0.33881021]
 [ 0.3388885 ]
 [ 0.34449363]
 [ 0.33804679]
 [ 0.34441835]
 [ 0.40077097]
 [ 0.33909421]
 [ 0.34560042]
 [ 0.33897642]]
	d = 0 doc_marg=-492.694083207
	d = 1 doc_marg=-471.22816683
	d = 2 doc_marg=-985.950074673
	d = 3 doc_marg=-694.120460884
	d = 4 doc_marg=-357.411326746
	d = 5 doc_marg=-175.747061237
	d = 6 doc_marg=-783.735221305
	d = 7 doc_marg=-834.775640808
	d = 8 doc_marg=-1298.64534775
	d = 9 doc_marg=-3446.01016626
	d = 10 doc_marg=-1410.89673235
	d = 11 doc_marg=-392.924964994
	d = 12 doc_marg=-4262.62873172
	d = 13 doc_marg=-172.821165902
	d = 14 doc_marg=-535.137488503
	d = 15 doc_marg=-1308.52520577
	d = 16 doc_marg=-219.71153337
	d = 17 doc_marg=-1302.92700337
	d = 18 doc_marg=-1043.46923499
	d = 19 doc_marg=-1795.38655988
	d = 20 doc_marg=-383.35879086
	d = 21 doc_marg=-266.079475317
	d = 22 doc_marg=-420.9711077
	d = 23 doc_marg=-1313.72854253
	d = 24 doc_marg=-1365.84655053
	d = 25 doc_marg=-1444.7585184
	d = 26 doc_marg=-1401.89319903
	d = 27 doc_marg=-1156.72399848
	d = 28 doc_marg=-1686.42801562
	d = 29 doc_marg=-1240.70366625
	d = 30 doc_marg=-923.461352083
	d = 31 doc_marg=-924.027518666
	d = 32 doc_marg=-1186.63575494
	d = 33 doc_marg=-817.375096234
	d = 34 doc_marg=-468.242699194
	d = 35 doc_marg=-597.779948115
	d = 36 doc_marg=-622.704572106
	d = 37 doc_marg=-1747.34737822
	d = 38 doc_marg=-938.46272591
	d = 39 doc_marg=-977.489735382
	d = 40 doc_marg=-1555.3728552
	d = 41 doc_marg=-1314.15742051
	d = 42 doc_marg=-2757.50211104
	d = 43 doc_marg=-1944.95900884
	d = 44 doc_marg=-830.031879271
	d = 45 doc_marg=-1144.02990574
	d = 46 doc_marg=-930.807599011
	d = 47 doc_marg=-1933.03827792
	d = 48 doc_marg=-2269.56497548
	d = 49 doc_marg=-1545.53287924
	d = 50 doc_marg=-889.797823448
	d = 51 doc_marg=-1018.40555658
	d = 52 doc_marg=-2567.57208677
	d = 53 doc_marg=-617.810667305
	d = 54 doc_marg=-2553.00039422
	d = 55 doc_marg=-606.245384842
	d = 56 doc_marg=-412.731419205
	d = 57 doc_marg=-464.887940805
	d = 58 doc_marg=-1793.55967931
	d = 59 doc_marg=-2011.49629576
	d = 60 doc_marg=-2000.1438935
	d = 61 doc_marg=-4125.29737676
	d = 62 doc_marg=-781.737390865
	d = 63 doc_marg=-813.328805176
	d = 64 doc_marg=-2354.32459933
	d = 65 doc_marg=-2093.61299301
	d = 66 doc_marg=-668.886697326
	d = 67 doc_marg=-1789.87186898
	d = 68 doc_marg=-190.035648914
	d = 69 doc_marg=-331.274110489
	d = 70 doc_marg=-1821.94021685
	d = 71 doc_marg=-2135.06600372
	d = 72 doc_marg=-1036.35124156
	d = 73 doc_marg=-4861.91522476
	d = 74 doc_marg=-1094.11167644
	d = 75 doc_marg=-3192.06183005
	d = 76 doc_marg=-973.160836998
	d = 77 doc_marg=-577.604736447
	d = 78 doc_marg=-1938.18022331
	d = 79 doc_marg=-799.656871501
	d = 80 doc_marg=-746.886790362
	d = 81 doc_marg=-919.501074307
	d = 82 doc_marg=-752.578194835
	d = 83 doc_marg=-944.377885383
	d = 84 doc_marg=-514.864908936
	d = 85 doc_marg=-315.365798055
	d = 86 doc_marg=-534.55348358
	d = 87 doc_marg=-1489.93614466
	d = 88 doc_marg=-185.284933027
	d = 89 doc_marg=-379.852381374
	d = 90 doc_marg=-388.761504155
	d = 91 doc_marg=-1341.79590058
	d = 92 doc_marg=-1907.52889874
	d = 93 doc_marg=-1003.34735238
	d = 94 doc_marg=-5559.7770305
	d = 95 doc_marg=-456.751744737
	d = 96 doc_marg=-1733.16721893
	d = 97 doc_marg=-664.333593744
	d = 98 doc_marg=-2191.35360568
	d = 99 doc_marg=-664.048406953
	d = 100 doc_marg=-1199.78757814
	d = 101 doc_marg=-585.57831242
	d = 102 doc_marg=-596.015047091
	d = 103 doc_marg=-1022.58596005
	d = 104 doc_marg=-1529.59568731
	d = 105 doc_marg=-595.050337566
	d = 106 doc_marg=-626.427434583
	d = 107 doc_marg=-3413.90976684
	d = 108 doc_marg=-528.381022123
	d = 109 doc_marg=-1461.56744787
	d = 110 doc_marg=-1369.9053568
	d = 111 doc_marg=-1084.86523908
	d = 112 doc_marg=-3752.7991099
	d = 113 doc_marg=-921.676283618
	d = 114 doc_marg=-846.494732918
	d = 115 doc_marg=-2187.25227046
	d = 116 doc_marg=-688.051945053
	d = 117 doc_marg=-162.842660709
	d = 118 doc_marg=-262.771768083
	d = 119 doc_marg=-3804.25086985
	d = 120 doc_marg=-757.255786461
	d = 121 doc_marg=-524.0033332
	d = 122 doc_marg=-1869.97224188
	d = 123 doc_marg=-4463.5250496
	d = 124 doc_marg=-1349.1916764
	d = 125 doc_marg=-1054.78558836
	d = 126 doc_marg=-1196.99434438
	d = 127 doc_marg=-1534.52813649
	d = 128 doc_marg=-1336.08088644
	d = 129 doc_marg=-1950.12885982
	d = 130 doc_marg=-4772.28265512
	d = 131 doc_marg=-1939.63082877
	d = 132 doc_marg=-635.661763827
	d = 133 doc_marg=-1784.92346897
	d = 134 doc_marg=-1992.31925136
	d = 135 doc_marg=-802.493654258
	d = 136 doc_marg=-3959.51918908
	d = 137 doc_marg=-1914.59100692
	d = 138 doc_marg=-1235.04827693
	d = 139 doc_marg=-1927.10420225
	d = 140 doc_marg=-347.067533119
	d = 141 doc_marg=-167.90376862
	d = 142 doc_marg=-1038.31707938
	d = 143 doc_marg=-1648.0297737
	d = 144 doc_marg=-549.69699034
	d = 145 doc_marg=-701.508784165
	d = 146 doc_marg=-1165.74193487
	d = 147 doc_marg=-1605.12177863
	d = 148 doc_marg=-814.531581818
	d = 149 doc_marg=-2340.02413341
	d = 150 doc_marg=-2268.74735346
	d = 151 doc_marg=-2320.1640732
	d = 152 doc_marg=-3839.62486887
	d = 153 doc_marg=-582.383694279
	d = 154 doc_marg=-502.788782081
	d = 155 doc_marg=-473.358930112
	d = 156 doc_marg=-273.8030622
	d = 157 doc_marg=-1102.10463798
	d = 158 doc_marg=-630.74877596
	d = 159 doc_marg=-752.382991756
	d = 160 doc_marg=-2437.10224986
	d = 161 doc_marg=-680.359460005
	d = 162 doc_marg=-2255.74593907
	d = 163 doc_marg=-589.080432326
	d = 164 doc_marg=-1595.79308258
	d = 165 doc_marg=-919.365287413
	d = 166 doc_marg=-908.8980506
	d = 167 doc_marg=-1572.6396114
	d = 168 doc_marg=-1257.34421403
	d = 169 doc_marg=-1542.02400276
	d = 170 doc_marg=-2044.84663455
	d = 171 doc_marg=-1284.48739856
	d = 172 doc_marg=-385.969420617
	d = 173 doc_marg=-1567.47497519
	d = 174 doc_marg=-1088.17162138
	d = 175 doc_marg=-4556.74233068
	d = 176 doc_marg=-3300.45160997
	d = 177 doc_marg=-249.990813608
	d = 178 doc_marg=-989.32911414
	d = 179 doc_marg=-559.744045294
	d = 180 doc_marg=-573.084032317
	d = 181 doc_marg=-1006.95440546
	d = 182 doc_marg=-2186.31368168
	d = 183 doc_marg=-1076.80881999
	d = 184 doc_marg=-947.065346818
	d = 185 doc_marg=-977.682186906
	d = 186 doc_marg=-874.547293836
	d = 187 doc_marg=-640.697501286
	d = 188 doc_marg=-323.056457765
	d = 189 doc_marg=-1286.52908763
	d = 190 doc_marg=-1106.64512837
	d = 191 doc_marg=-1414.78401426
	d = 192 doc_marg=-1204.76275976
	d = 193 doc_marg=-1929.24445325
	d = 194 doc_marg=-1050.22203133
	d = 195 doc_marg=-1841.54677018
	d = 196 doc_marg=-551.216739979
	d = 197 doc_marg=-259.741881336
	d = 198 doc_marg=-475.116236117
	d = 199 doc_marg=-1701.271902
	d = 200 doc_marg=-1023.17985556
	d = 201 doc_marg=-1891.90675962
	d = 202 doc_marg=-4205.98258652
	d = 203 doc_marg=-1224.66559469
	d = 204 doc_marg=-684.897786187
	d = 205 doc_marg=-554.932361172
	d = 206 doc_marg=-431.518587413
	d = 207 doc_marg=-1508.68517869
	d = 208 doc_marg=-966.698459121
	d = 209 doc_marg=-839.754187648
	d = 210 doc_marg=-487.488620107
	d = 211 doc_marg=-819.607712544
	d = 212 doc_marg=-2670.56830487
	d = 213 doc_marg=-1719.27787374
Log evidence 0 = -284307.812525
Test perplexity 0 = 33.9058931129

K=400 Training fold=0
K=400 Testing fold=1
K=400 Training fold=2
K=400 Training fold=3
Run training gibbs (642, 1664)
CGS LDA initialising
.................................................................
Using Numba for LDA sampling
Preparing words
Preparing Z matrix
DONE
Sample 1   Log joint likelihood = -2532223.336 
Sample 2   Log joint likelihood = -1598126.810 
Sample 3   Log joint likelihood = -1193127.620 
Sample 4   Log joint likelihood = -1070737.015 
Sample 5   Log joint likelihood = -1020370.894 
Sample 6   Log joint likelihood = -990595.279 
Sample 7   Log joint likelihood = -971941.805 
Sample 8   Log joint likelihood = -957664.703 
Sample 9   Log joint likelihood = -947795.319 
Sample 10   Log joint likelihood = -940419.314 
Sample 11   Log joint likelihood = -933904.302 
Sample 12   Log joint likelihood = -927842.575 
Sample 13   Log joint likelihood = -922380.037 
Sample 14   Log joint likelihood = -917920.027 
Sample 15   Log joint likelihood = -915178.517 
Sample 16   Log joint likelihood = -911290.504 
Sample 17   Log joint likelihood = -909017.573 
Sample 18   Log joint likelihood = -906241.711 
Sample 19   Log joint likelihood = -902345.845 
Sample 20   Log joint likelihood = -900627.866 
Sample 21   Log joint likelihood = -899335.910 
Sample 22   Log joint likelihood = -898512.997 
Sample 23   Log joint likelihood = -897281.029 
Sample 24   Log joint likelihood = -895899.551 
Sample 25   Log joint likelihood = -895325.846 
Sample 26   Log joint likelihood = -893889.973 
Sample 27   Log joint likelihood = -891848.631 
Sample 28   Log joint likelihood = -891403.580 
Sample 29   Log joint likelihood = -890917.353 
Sample 30   Log joint likelihood = -890307.212 
Sample 31   Log joint likelihood = -889179.698 
Sample 32   Log joint likelihood = -887888.443 
Sample 33   Log joint likelihood = -887179.657 
Sample 34   Log joint likelihood = -887173.594 
Sample 35   Log joint likelihood = -886373.580 
Sample 36   Log joint likelihood = -885289.125 
Sample 37   Log joint likelihood = -884666.615 
Sample 38   Log joint likelihood = -883723.569 
Sample 39   Log joint likelihood = -883661.613 
Sample 40   Log joint likelihood = -882599.307 
Sample 41   Log joint likelihood = -881780.212 
Sample 42   Log joint likelihood = -880411.697 
Sample 43   Log joint likelihood = -880505.829 
Sample 44   Log joint likelihood = -879423.509 
Sample 45   Log joint likelihood = -878178.105 
Sample 46   Log joint likelihood = -877855.511 
Sample 47   Log joint likelihood = -878058.460 
Sample 48   Log joint likelihood = -877828.846 
Sample 49   Log joint likelihood = -876988.373 
Sample 50   Log joint likelihood = -876553.567 
Run testing importance sampling (214, 1664)
topic_prior = [[ 0.33602973]
 [ 0.35019266]
 [ 0.33367597]
 [ 0.33493321]
 [ 0.34702943]
 [ 0.33760558]
 [ 0.34681205]
 [ 0.33540138]
 [ 0.33631194]
 [ 0.33708297]
 [ 0.33478827]
 [ 0.34145627]
 [ 0.34170238]
 [ 0.33463875]
 [ 0.3364532 ]
 [ 0.33367597]
 [ 0.34551029]
 [ 0.33499199]
 [ 0.3349317 ]
 [ 0.34514876]
 [ 0.33725553]
 [ 0.40159152]
 [ 0.33333665]
 [ 0.33665508]
 [ 0.33788585]
 [ 0.36035472]
 [ 0.34896615]
 [ 0.33642458]
 [ 0.33549444]
 [ 0.34060275]
 [ 0.33602222]
 [ 0.33694107]
 [ 0.35871114]
 [ 0.33705667]
 [ 0.33816155]
 [ 0.33790233]
 [ 0.33557526]
 [ 0.33470604]
 [ 0.33919776]
 [ 0.33971481]
 [ 0.33929204]
 [ 0.35083608]
 [ 0.33333665]
 [ 0.34082599]
 [ 0.33873886]
 [ 0.33646423]
 [ 0.34302577]
 [ 0.33465479]
 [ 0.33506184]
 [ 0.34081867]
 [ 0.33643462]
 [ 0.35121194]
 [ 0.33401593]
 [ 0.33839224]
 [ 0.33634359]
 [ 0.40604099]
 [ 0.33695019]
 [ 0.33604722]
 [ 0.33477843]
 [ 0.33367597]
 [ 0.33706063]
 [ 0.34079874]
 [ 0.33891964]
 [ 0.37366523]
 [ 0.33806473]
 [ 0.33489698]
 [ 0.33643557]
 [ 0.33333665]
 [ 0.3360127 ]
 [ 0.33808197]
 [ 0.33704013]
 [ 0.33809562]
 [ 0.33333665]
 [ 0.33700833]
 [ 0.33560668]
 [ 0.33666974]
 [ 0.33333665]
 [ 0.33435651]
 [ 0.33367597]
 [ 0.33477008]
 [ 0.34482093]
 [ 0.33819022]
 [ 0.33789905]
 [ 0.33800663]
 [ 0.3370699 ]
 [ 0.33846698]
 [ 0.33827909]
 [ 0.4372612 ]
 [ 0.33401593]
 [ 0.33878685]
 [ 0.3370149 ]
 [ 0.34034171]
 [ 0.33856914]
 [ 0.33510108]
 [ 0.33582096]
 [ 0.33333665]
 [ 0.33649513]
 [ 0.33806664]
 [ 0.35404765]
 [ 0.33367597]
 [ 0.33401593]
 [ 0.33894119]
 [ 0.3421486 ]
 [ 0.34736025]
 [ 0.3391018 ]
 [ 0.33819442]
 [ 0.33513865]
 [ 0.33411445]
 [ 0.3368327 ]
 [ 0.3883161 ]
 [ 0.34309969]
 [ 0.35011286]
 [ 0.33333665]
 [ 0.33668442]
 [ 0.37883685]
 [ 0.33606705]
 [ 0.3407743 ]
 [ 0.33484246]
 [ 0.34401888]
 [ 0.33804   ]
 [ 0.34194508]
 [ 0.33435651]
 [ 0.33644528]
 [ 0.33610165]
 [ 0.34463113]
 [ 0.33673986]
 [ 0.33513865]
 [ 0.43154185]
 [ 0.33788994]
 [ 0.33535241]
 [ 0.33706572]
 [ 0.33527712]
 [ 0.33703004]
 [ 0.33490929]
 [ 0.34042094]
 [ 0.33894343]
 [ 0.34304441]
 [ 0.3386421 ]
 [ 0.33469773]
 [ 0.33981853]
 [ 0.33763728]
 [ 0.33699888]
 [ 0.33604351]
 [ 0.336818  ]
 [ 0.33660131]
 [ 0.36851889]
 [ 0.34076471]
 [ 0.33367597]
 [ 0.33836872]
 [ 0.41422305]
 [ 0.3423468 ]
 [ 0.33450364]
 [ 0.33851766]
 [ 0.33898333]
 [ 0.3365189 ]
 [ 0.33401593]
 [ 0.3429337 ]
 [ 0.43371813]
 [ 0.33495655]
 [ 0.38682885]
 [ 0.33661199]
 [ 0.33536795]
 [ 0.33473408]
 [ 0.33516214]
 [ 0.33413703]
 [ 0.3357252 ]
 [ 0.33485161]
 [ 0.33762084]
 [ 0.33810847]
 [ 0.34092497]
 [ 0.34152211]
 [ 0.33636561]
 [ 0.34077851]
 [ 0.33667268]
 [ 0.337734  ]
 [ 0.33536627]
 [ 0.34597628]
 [ 0.33907517]
 [ 0.33517121]
 [ 0.33695894]
 [ 0.33863756]
 [ 0.3611749 ]
 [ 0.34189716]
 [ 0.33636926]
 [ 0.33496337]
 [ 0.33367597]
 [ 0.34953364]
 [ 0.33478922]
 [ 0.34020725]
 [ 0.33629494]
 [ 0.34817403]
 [ 0.33759088]
 [ 0.33571243]
 [ 0.34450463]
 [ 0.36534176]
 [ 0.33661795]
 [ 0.34369746]
 [ 0.33560045]
 [ 0.33945644]
 [ 0.33494304]
 [ 0.34054391]
 [ 0.33725569]
 [ 0.3390574 ]
 [ 0.3376642 ]
 [ 0.33496964]
 [ 0.33465702]
 [ 0.33803929]
 [ 0.33782011]
 [ 0.33809017]
 [ 0.33479662]
 [ 0.33552704]
 [ 0.33469773]
 [ 0.3359704 ]
 [ 0.3368931 ]
 [ 0.36552321]
 [ 0.34053607]
 [ 0.33525415]
 [ 0.33673119]
 [ 0.34279698]
 [ 0.3356756 ]
 [ 0.33451137]
 [ 0.33669821]
 [ 0.33445522]
 [ 0.33543052]
 [ 0.33701992]
 [ 0.33618223]
 [ 0.33611408]
 [ 0.33665596]
 [ 0.33943107]
 [ 0.33508262]
 [ 0.33333665]
 [ 0.33946872]
 [ 0.33824607]
 [ 0.33712651]
 [ 0.33435651]
 [ 0.40270326]
 [ 0.33702083]
 [ 0.33595328]
 [ 0.3481924 ]
 [ 0.34407183]
 [ 0.33812957]
 [ 0.33831609]
 [ 0.34180942]
 [ 0.33333665]
 [ 0.33498719]
 [ 0.33377431]
 [ 0.33453574]
 [ 0.34642127]
 [ 0.36239219]
 [ 0.33514399]
 [ 0.33706088]
 [ 0.33774398]
 [ 0.34402901]
 [ 0.34002416]
 [ 0.33573118]
 [ 0.33863576]
 [ 0.41215152]
 [ 0.33686332]
 [ 0.33944817]
 [ 0.33982681]
 [ 0.3408211 ]
 [ 0.33667974]
 [ 0.33537881]
 [ 0.36760705]
 [ 0.33463847]
 [ 0.33435651]
 [ 0.3415445 ]
 [ 0.33845198]
 [ 0.34617727]
 [ 0.33644911]
 [ 0.35125682]
 [ 0.33435651]
 [ 0.33437113]
 [ 0.33367597]
 [ 0.33546509]
 [ 0.33456459]
 [ 0.34082288]
 [ 0.33493358]
 [ 0.33603211]
 [ 0.33746337]
 [ 0.33648166]
 [ 0.3390229 ]
 [ 0.34558202]
 [ 0.33538348]
 [ 0.33572134]
 [ 0.33480794]
 [ 0.3356203 ]
 [ 0.33688325]
 [ 0.33367597]
 [ 0.35730747]
 [ 0.33858653]
 [ 0.33965713]
 [ 0.34760307]
 [ 0.34117835]
 [ 0.34195569]
 [ 0.33720292]
 [ 0.33962952]
 [ 0.33367597]
 [ 0.35366501]
 [ 0.3366651 ]
 [ 0.33367597]
 [ 0.33751007]
 [ 0.33585574]
 [ 0.3402048 ]
 [ 0.38497161]
 [ 0.37822966]
 [ 0.34844516]
 [ 0.3356087 ]
 [ 0.3399876 ]
 [ 0.33599796]
 [ 0.34416217]
 [ 0.33446227]
 [ 0.33709371]
 [ 0.33367597]
 [ 0.35808959]
 [ 0.33703741]
 [ 0.340181  ]
 [ 0.33728224]
 [ 0.33401593]
 [ 0.3377109 ]
 [ 0.33460172]
 [ 0.33648405]
 [ 0.33435651]
 [ 0.338468  ]
 [ 0.34325422]
 [ 0.33712594]
 [ 0.33941053]
 [ 0.33811393]
 [ 0.33333665]
 [ 0.35596952]
 [ 0.33471237]
 [ 0.33556013]
 [ 0.33685123]
 [ 0.33613462]
 [ 0.33734733]
 [ 0.33683477]
 [ 0.33565993]
 [ 0.33495558]
 [ 0.33435651]
 [ 0.33367597]
 [ 0.33543525]
 [ 0.33662368]
 [ 0.33601663]
 [ 0.33826474]
 [ 0.34708443]
 [ 0.33575433]
 [ 0.33932123]
 [ 0.33816976]
 [ 0.33989858]
 [ 0.37084212]
 [ 0.33552568]
 [ 0.33675909]
 [ 0.33517372]
 [ 0.33651891]
 [ 0.33729216]
 [ 0.33647433]
 [ 0.33572893]
 [ 0.39364015]
 [ 0.3499603 ]
 [ 0.33490797]
 [ 0.33901751]
 [ 0.34470801]
 [ 0.33435651]
 [ 0.3466505 ]
 [ 0.33694007]
 [ 0.34149115]
 [ 0.37361279]
 [ 0.35248617]
 [ 0.336002  ]
 [ 0.34906512]
 [ 0.33894904]
 [ 0.33482465]
 [ 0.34247969]
 [ 0.33666596]
 [ 0.35071374]
 [ 0.33445522]
 [ 0.34702242]
 [ 0.35626775]
 [ 0.33367597]
 [ 0.33742086]
 [ 0.3348773 ]
 [ 0.33464419]
 [ 0.33663629]
 [ 0.34166396]
 [ 0.35338441]
 [ 0.33718276]
 [ 0.33526377]
 [ 0.35976443]
 [ 0.35720362]
 [ 0.37364521]
 [ 0.33552649]
 [ 0.33907677]
 [ 0.34530972]
 [ 0.33333665]
 [ 0.34287993]
 [ 0.33955112]
 [ 0.33947162]
 [ 0.3422547 ]
 [ 0.33899918]
 [ 0.39058317]]
	d = 0 doc_marg=-478.229136624
	d = 1 doc_marg=-472.541177721
	d = 2 doc_marg=-984.744874176
	d = 3 doc_marg=-543.542170399
	d = 4 doc_marg=-358.910591485
	d = 5 doc_marg=-177.108755023
	d = 6 doc_marg=-629.370249328
	d = 7 doc_marg=-259.553449498
	d = 8 doc_marg=-1373.81285099
	d = 9 doc_marg=-2053.9954109
	d = 10 doc_marg=-836.138902965
	d = 11 doc_marg=-395.769295517
	d = 12 doc_marg=-2925.19906942
	d = 13 doc_marg=-176.351405708
	d = 14 doc_marg=-513.187671054
	d = 15 doc_marg=-1459.05041635
	d = 16 doc_marg=-219.41892041
	d = 17 doc_marg=-1660.42726588
	d = 18 doc_marg=-1075.85867991
	d = 19 doc_marg=-1422.27422391
	d = 20 doc_marg=-379.428094535
	d = 21 doc_marg=-259.3732134
	d = 22 doc_marg=-259.902408641
	d = 23 doc_marg=-1142.95942723
	d = 24 doc_marg=-1967.36788778
	d = 25 doc_marg=-1903.21585686
	d = 26 doc_marg=-1399.51084181
	d = 27 doc_marg=-1204.77676254
	d = 28 doc_marg=-1756.29026683
	d = 29 doc_marg=-1099.6760332
	d = 30 doc_marg=-878.174659425
	d = 31 doc_marg=-1289.74916218
	d = 32 doc_marg=-1081.59709913
	d = 33 doc_marg=-893.79574511
	d = 34 doc_marg=-482.115583359
	d = 35 doc_marg=-1208.25022367
	d = 36 doc_marg=-721.447764608
	d = 37 doc_marg=-1747.65237651
	d = 38 doc_marg=-2045.87721203
	d = 39 doc_marg=-1038.8180806
	d = 40 doc_marg=-1640.97117961
	d = 41 doc_marg=-1304.36514251
	d = 42 doc_marg=-2871.32675568
	d = 43 doc_marg=-1676.52707427
	d = 44 doc_marg=-389.924544057
	d = 45 doc_marg=-1374.80691604
	d = 46 doc_marg=-1190.10893487
	d = 47 doc_marg=-2785.97380494
	d = 48 doc_marg=-2608.96857237
	d = 49 doc_marg=-1019.89201488
	d = 50 doc_marg=-1035.39799979
	d = 51 doc_marg=-1116.59356187
	d = 52 doc_marg=-2311.20621318
	d = 53 doc_marg=-643.094571635
	d = 54 doc_marg=-2488.00183346
	d = 55 doc_marg=-596.813915048
	d = 56 doc_marg=-420.147670363
	d = 57 doc_marg=-465.669012244
	d = 58 doc_marg=-1936.2266444
	d = 59 doc_marg=-2445.39557441
	d = 60 doc_marg=-1932.07076995
	d = 61 doc_marg=-4108.57388304
	d = 62 doc_marg=-850.237584721
	d = 63 doc_marg=-902.258269654
	d = 64 doc_marg=-2610.18514848
	d = 65 doc_marg=-1857.80043415
	d = 66 doc_marg=-622.3392393
	d = 67 doc_marg=-1793.65580493
	d = 68 doc_marg=-204.537906931
	d = 69 doc_marg=-275.698485833
	d = 70 doc_marg=-1294.73074483
	d = 71 doc_marg=-2155.94424333
	d = 72 doc_marg=-996.03281685
	d = 73 doc_marg=-2606.5104143
	d = 74 doc_marg=-970.825486784
	d = 75 doc_marg=-3444.60706767
	d = 76 doc_marg=-909.75411476
	d = 77 doc_marg=-626.731307345
	d = 78 doc_marg=-1971.5684178
	d = 79 doc_marg=-695.409883239
	d = 80 doc_marg=-734.533232572
	d = 81 doc_marg=-842.859772279
	d = 82 doc_marg=-712.304087973
	d = 83 doc_marg=-1040.60485335
	d = 84 doc_marg=-530.640270482
	d = 85 doc_marg=-344.515203661
	d = 86 doc_marg=-536.641554899
	d = 87 doc_marg=-1355.01780414
	d = 88 doc_marg=-188.350783437
	d = 89 doc_marg=-389.568473631
	d = 90 doc_marg=-389.152957537
	d = 91 doc_marg=-1503.43297288
	d = 92 doc_marg=-1913.7156605
	d = 93 doc_marg=-946.544439564
	d = 94 doc_marg=-5562.28388011
	d = 95 doc_marg=-466.1395201
	d = 96 doc_marg=-1285.92207155
	d = 97 doc_marg=-659.628235149
	d = 98 doc_marg=-2174.04446132
	d = 99 doc_marg=-633.309108885
	d = 100 doc_marg=-1143.04287387
	d = 101 doc_marg=-578.081212462
	d = 102 doc_marg=-583.540059973
	d = 103 doc_marg=-1174.07736206
	d = 104 doc_marg=-1722.2068917
	d = 105 doc_marg=-572.965912768
	d = 106 doc_marg=-537.735774841
	d = 107 doc_marg=-3341.22306918
	d = 108 doc_marg=-529.964592775
	d = 109 doc_marg=-1432.01035853
	d = 110 doc_marg=-2034.64899701
	d = 111 doc_marg=-1039.5774676
	d = 112 doc_marg=-3029.7302006
	d = 113 doc_marg=-907.829437515
	d = 114 doc_marg=-788.79529446
	d = 115 doc_marg=-1526.1223494
	d = 116 doc_marg=-733.471355824
	d = 117 doc_marg=-164.185198232
	d = 118 doc_marg=-272.914252111
	d = 119 doc_marg=-3967.83634053
	d = 120 doc_marg=-795.45003963
	d = 121 doc_marg=-616.685322603
	d = 122 doc_marg=-1577.66166482
	d = 123 doc_marg=-3407.21048024
	d = 124 doc_marg=-1152.8490979
	d = 125 doc_marg=-1041.94414191
	d = 126 doc_marg=-1444.52436202
	d = 127 doc_marg=-1594.84888011
	d = 128 doc_marg=-1334.42861767
	d = 129 doc_marg=-2000.7238171
	d = 130 doc_marg=-4170.65365871
	d = 131 doc_marg=-1871.03093003
	d = 132 doc_marg=-865.208843215
	d = 133 doc_marg=-1593.3057671
	d = 134 doc_marg=-1982.74269859
	d = 135 doc_marg=-791.372336583
	d = 136 doc_marg=-4009.80425189
	d = 137 doc_marg=-1910.14229614
	d = 138 doc_marg=-1644.1389645
	d = 139 doc_marg=-1985.87924434
	d = 140 doc_marg=-342.016202179
	d = 141 doc_marg=-168.319469863
	d = 142 doc_marg=-914.794673413
	d = 143 doc_marg=-1269.62221478
	d = 144 doc_marg=-614.601282468
	d = 145 doc_marg=-756.306220778
	d = 146 doc_marg=-1208.03660325
	d = 147 doc_marg=-1624.66761617
	d = 148 doc_marg=-840.310239298
	d = 149 doc_marg=-2050.64243943
	d = 150 doc_marg=-3752.94362401
	d = 151 doc_marg=-2306.90769857
	d = 152 doc_marg=-5526.97790219
	d = 153 doc_marg=-600.198550003
	d = 154 doc_marg=-555.057900708
	d = 155 doc_marg=-1260.65910371
	d = 156 doc_marg=-268.625514728
	d = 157 doc_marg=-1153.39800735
	d = 158 doc_marg=-690.714893838
	d = 159 doc_marg=-760.210778498
	d = 160 doc_marg=-1861.69984373
	d = 161 doc_marg=-1095.47390254
	d = 162 doc_marg=-1657.60726224
	d = 163 doc_marg=-613.12920025
	d = 164 doc_marg=-1921.49059335
	d = 165 doc_marg=-1667.67953162
	d = 166 doc_marg=-959.482907179
	d = 167 doc_marg=-1692.30395434
	d = 168 doc_marg=-1230.65820351
	d = 169 doc_marg=-1523.1617455
	d = 170 doc_marg=-2056.19161905
	d = 171 doc_marg=-1231.60061796
	d = 172 doc_marg=-383.867048228
	d = 173 doc_marg=-1582.90614286
	d = 174 doc_marg=-1109.53133328
	d = 175 doc_marg=-4301.70638806
	d = 176 doc_marg=-3067.70908667
	d = 177 doc_marg=-260.261581367
	d = 178 doc_marg=-736.238101417
	d = 179 doc_marg=-617.88739191
	d = 180 doc_marg=-599.906683829
	d = 181 doc_marg=-1569.35376706
	d = 182 doc_marg=-2492.37478963
	d = 183 doc_marg=-1086.9918561
	d = 184 doc_marg=-959.889512135
	d = 185 doc_marg=-954.470385995
	d = 186 doc_marg=-872.480561493
	d = 187 doc_marg=-628.466089059
	d = 188 doc_marg=-360.832057092
	d = 189 doc_marg=-1248.39374657
	d = 190 doc_marg=-1023.08241445
	d = 191 doc_marg=-1397.21428479
	d = 192 doc_marg=-1181.21378983
	d = 193 doc_marg=-2555.39006134
	d = 194 doc_marg=-1453.81843939
	d = 195 doc_marg=-2175.55881352
	d = 196 doc_marg=-525.877622928
	d = 197 doc_marg=-358.699178498
	d = 198 doc_marg=-618.474026653
	d = 199 doc_marg=-1881.83166003
	d = 200 doc_marg=-921.869751125
	d = 201 doc_marg=-1851.01679598
	d = 202 doc_marg=-2643.83617779
	d = 203 doc_marg=-1821.38566862
	d = 204 doc_marg=-683.914116854
	d = 205 doc_marg=-575.082858276
	d = 206 doc_marg=-462.480225026
	d = 207 doc_marg=-1541.31654393
	d = 208 doc_marg=-1001.39870735
	d = 209 doc_marg=-865.791664017
	d = 210 doc_marg=-492.757764004
	d = 211 doc_marg=-998.966390884
	d = 212 doc_marg=-2670.42686516
	d = 213 doc_marg=-2115.88770062
Log evidence 1 = -284832.169297
Test perplexity 1 = 34.1269532477

K=400 Training fold=0
K=400 Training fold=1
K=400 Testing fold=2
K=400 Training fold=3
Run training gibbs (642, 1664)
CGS LDA initialising
.................................................................
Using Numba for LDA sampling
Preparing words
Preparing Z matrix
DONE
Sample 1   Log joint likelihood = -2442539.019 
Sample 2   Log joint likelihood = -1555573.549 
Sample 3   Log joint likelihood = -1155247.017 
Sample 4   Log joint likelihood = -1027262.396 
Sample 5   Log joint likelihood = -976338.694 
Sample 6   Log joint likelihood = -950141.968 
Sample 7   Log joint likelihood = -932875.045 
Sample 8   Log joint likelihood = -921062.498 
Sample 9   Log joint likelihood = -911944.509 
Sample 10   Log joint likelihood = -904103.098 
Sample 11   Log joint likelihood = -897143.736 
Sample 12   Log joint likelihood = -892422.984 
Sample 13   Log joint likelihood = -887575.860 
Sample 14   Log joint likelihood = -882598.340 
Sample 15   Log joint likelihood = -879018.874 
Sample 16   Log joint likelihood = -875601.691 
Sample 17   Log joint likelihood = -873645.874 
Sample 18   Log joint likelihood = -871756.494 
Sample 19   Log joint likelihood = -869975.394 
Sample 20   Log joint likelihood = -868357.935 
Sample 21   Log joint likelihood = -867078.842 
Sample 22   Log joint likelihood = -864597.671 
Sample 23   Log joint likelihood = -862969.331 
Sample 24   Log joint likelihood = -860708.876 
Sample 25   Log joint likelihood = -858515.042 
Sample 26   Log joint likelihood = -856655.044 
Sample 27   Log joint likelihood = -855152.173 
Sample 28   Log joint likelihood = -853821.245 
Sample 29   Log joint likelihood = -852781.561 
Sample 30   Log joint likelihood = -852054.426 
Sample 31   Log joint likelihood = -849896.821 
Sample 32   Log joint likelihood = -848134.279 
Sample 33   Log joint likelihood = -847238.460 
Sample 34   Log joint likelihood = -845974.539 
Sample 35   Log joint likelihood = -845153.688 
Sample 36   Log joint likelihood = -844411.206 
Sample 37   Log joint likelihood = -843641.924 
Sample 38   Log joint likelihood = -842496.627 
Sample 39   Log joint likelihood = -842345.705 
Sample 40   Log joint likelihood = -841568.079 
Sample 41   Log joint likelihood = -841441.823 
Sample 42   Log joint likelihood = -841311.922 
Sample 43   Log joint likelihood = -840569.686 
Sample 44   Log joint likelihood = -839958.538 
Sample 45   Log joint likelihood = -839322.957 
Sample 46   Log joint likelihood = -838325.529 
Sample 47   Log joint likelihood = -838077.060 
Sample 48   Log joint likelihood = -836867.651 
Sample 49   Log joint likelihood = -836837.402 
Sample 50   Log joint likelihood = -836348.423 
Run testing importance sampling (214, 1664)
topic_prior = [[ 0.34034782]
 [ 0.34641478]
 [ 0.33969917]
 [ 0.34002119]
 [ 0.33842584]
 [ 0.34331905]
 [ 0.3372585 ]
 [ 0.34183997]
 [ 0.34093256]
 [ 0.34536808]
 [ 0.33898459]
 [ 0.34560055]
 [ 0.35018901]
 [ 0.34418895]
 [ 0.33835309]
 [ 0.33760512]
 [ 0.34936653]
 [ 0.34019791]
 [ 0.34087593]
 [ 0.33916953]
 [ 0.34089866]
 [ 0.37144626]
 [ 0.33961037]
 [ 0.34505705]
 [ 0.33953864]
 [ 0.33943046]
 [ 0.47892343]
 [ 0.34562658]
 [ 0.34052314]
 [ 0.34027413]
 [ 0.34198621]
 [ 0.37314272]
 [ 0.34026387]
 [ 0.34481991]
 [ 0.35469476]
 [ 0.34158485]
 [ 0.34046677]
 [ 0.33947136]
 [ 0.3443091 ]
 [ 0.33840368]
 [ 0.33831524]
 [ 0.33901462]
 [ 0.33691252]
 [ 0.34913686]
 [ 0.3448528 ]
 [ 0.34314307]
 [ 0.34596123]
 [ 0.34411057]
 [ 0.33946315]
 [ 0.33656719]
 [ 0.36287845]
 [ 0.36047594]
 [ 0.33936144]
 [ 0.33691252]
 [ 0.34318856]
 [ 0.33952699]
 [ 0.34265279]
 [ 0.34239733]
 [ 0.41364387]
 [ 0.34124866]
 [ 0.34120953]
 [ 0.34184708]
 [ 0.35996629]
 [ 0.3372585 ]
 [ 0.34026296]
 [ 0.33691252]
 [ 0.33927059]
 [ 0.34366195]
 [ 0.3389302 ]
 [ 0.34266007]
 [ 0.34633996]
 [ 0.34070216]
 [ 0.34526407]
 [ 0.33770557]
 [ 0.34078703]
 [ 0.36224745]
 [ 0.35261608]
 [ 0.34172884]
 [ 0.34093062]
 [ 0.34570656]
 [ 0.34476262]
 [ 0.3591664 ]
 [ 0.3381721 ]
 [ 0.34179764]
 [ 0.35019482]
 [ 0.33963177]
 [ 0.33691252]
 [ 0.34827805]
 [ 0.34173227]
 [ 0.34129178]
 [ 0.34104711]
 [ 0.34099062]
 [ 0.33922505]
 [ 0.3372585 ]
 [ 0.3399527 ]
 [ 0.33828007]
 [ 0.33862403]
 [ 0.34030368]
 [ 0.34113052]
 [ 0.33656719]
 [ 0.3396952 ]
 [ 0.33968307]
 [ 0.33788633]
 [ 0.3409813 ]
 [ 0.34106069]
 [ 0.34249974]
 [ 0.40435491]
 [ 0.34121693]
 [ 0.34091842]
 [ 0.35715134]
 [ 0.35901733]
 [ 0.33848667]
 [ 0.34221048]
 [ 0.34334755]
 [ 0.34283127]
 [ 0.34199404]
 [ 0.33908351]
 [ 0.34328588]
 [ 0.34126428]
 [ 0.35382926]
 [ 0.34444243]
 [ 0.34095989]
 [ 0.33691252]
 [ 0.3372585 ]
 [ 0.33656719]
 [ 0.3372585 ]
 [ 0.34446558]
 [ 0.33789926]
 [ 0.33799872]
 [ 0.34574162]
 [ 0.4099161 ]
 [ 0.33859447]
 [ 0.33691252]
 [ 0.33777911]
 [ 0.33851468]
 [ 0.33808833]
 [ 0.34342903]
 [ 0.33780114]
 [ 0.33691252]
 [ 0.35717373]
 [ 0.33931837]
 [ 0.33760512]
 [ 0.33930211]
 [ 0.33874541]
 [ 0.33691252]
 [ 0.35271583]
 [ 0.33762919]
 [ 0.34758094]
 [ 0.34159574]
 [ 0.33969506]
 [ 0.33903974]
 [ 0.34307314]
 [ 0.34072207]
 [ 0.33834802]
 [ 0.33795239]
 [ 0.34213027]
 [ 0.33691252]
 [ 0.33762   ]
 [ 0.33991932]
 [ 0.35289149]
 [ 0.34973625]
 [ 0.34188745]
 [ 0.34320296]
 [ 0.44269882]
 [ 0.34023547]
 [ 0.34004821]
 [ 0.33842662]
 [ 0.33656719]
 [ 0.34088164]
 [ 0.34035693]
 [ 0.34019335]
 [ 0.34007421]
 [ 0.34530109]
 [ 0.34956932]
 [ 0.33656719]
 [ 0.35238892]
 [ 0.33656719]
 [ 0.33795239]
 [ 0.33909075]
 [ 0.33910845]
 [ 0.33691252]
 [ 0.39453293]
 [ 0.33867848]
 [ 0.34084081]
 [ 0.33981892]
 [ 0.3388667 ]
 [ 0.34157638]
 [ 0.33761191]
 [ 0.34001689]
 [ 0.38763179]
 [ 0.34003221]
 [ 0.34249653]
 [ 0.34123346]
 [ 0.34402624]
 [ 0.34373716]
 [ 0.33969499]
 [ 0.40475796]
 [ 0.3469148 ]
 [ 0.34317503]
 [ 0.34000676]
 [ 0.35057867]
 [ 0.33981148]
 [ 0.33852752]
 [ 0.34195244]
 [ 0.34355653]
 [ 0.34240851]
 [ 0.33760512]
 [ 0.34008408]
 [ 0.33897016]
 [ 0.36456428]
 [ 0.33899991]
 [ 0.33819805]
 [ 0.33656719]
 [ 0.35110557]
 [ 0.34644741]
 [ 0.33888117]
 [ 0.33911544]
 [ 0.34040807]
 [ 0.34237928]
 [ 0.3429938 ]
 [ 0.34044542]
 [ 0.3673643 ]
 [ 0.34088287]
 [ 0.34068246]
 [ 0.33735876]
 [ 0.34219347]
 [ 0.33767862]
 [ 0.3372585 ]
 [ 0.34196553]
 [ 0.33889847]
 [ 0.33814928]
 [ 0.33974975]
 [ 0.34248171]
 [ 0.34506918]
 [ 0.3458751 ]
 [ 0.3382077 ]
 [ 0.34622021]
 [ 0.34625121]
 [ 0.34027519]
 [ 0.34519073]
 [ 0.33920778]
 [ 0.33842022]
 [ 0.3372585 ]
 [ 0.33691252]
 [ 0.33877464]
 [ 0.34248934]
 [ 0.34074321]
 [ 0.33953164]
 [ 0.40749277]
 [ 0.34052437]
 [ 0.33828556]
 [ 0.3372585 ]
 [ 0.33892145]
 [ 0.33831524]
 [ 0.36007946]
 [ 0.33904114]
 [ 0.3398654 ]
 [ 0.35438119]
 [ 0.34882481]
 [ 0.3390251 ]
 [ 0.33691252]
 [ 0.35115736]
 [ 0.33848341]
 [ 0.34197253]
 [ 0.33830032]
 [ 0.35214929]
 [ 0.33828124]
 [ 0.34671227]
 [ 0.34146302]
 [ 0.33795239]
 [ 0.34002709]
 [ 0.33691252]
 [ 0.34114702]
 [ 0.34029104]
 [ 0.34099171]
 [ 0.33760512]
 [ 0.33875385]
 [ 0.34108237]
 [ 0.34324158]
 [ 0.33874155]
 [ 0.34521322]
 [ 0.39054122]
 [ 0.36061649]
 [ 0.34002912]
 [ 0.34071194]
 [ 0.33954484]
 [ 0.3372585 ]
 [ 0.34216176]
 [ 0.34042158]
 [ 0.36316169]
 [ 0.3478774 ]
 [ 0.33760512]
 [ 0.33972259]
 [ 0.33825703]
 [ 0.33998009]
 [ 0.33897181]
 [ 0.33949976]
 [ 0.34120438]
 [ 0.33939204]
 [ 0.36536851]
 [ 0.33902897]
 [ 0.33981897]
 [ 0.36278462]
 [ 0.33915887]
 [ 0.33967913]
 [ 0.38240342]
 [ 0.34220144]
 [ 0.3372585 ]
 [ 0.34210516]
 [ 0.33960487]
 [ 0.33816455]
 [ 0.33797349]
 [ 0.34092262]
 [ 0.34149423]
 [ 0.34321863]
 [ 0.34118789]
 [ 0.34705372]
 [ 0.34076334]
 [ 0.34230938]
 [ 0.34276645]
 [ 0.34029904]
 [ 0.34181012]
 [ 0.33992644]
 [ 0.40121656]
 [ 0.34008567]
 [ 0.33897962]
 [ 0.34247889]
 [ 0.34053065]
 [ 0.33919268]
 [ 0.35218823]
 [ 0.34041636]
 [ 0.35312804]
 [ 0.33978338]
 [ 0.3465989 ]
 [ 0.34992232]
 [ 0.33862467]
 [ 0.33878261]
 [ 0.3441145 ]
 [ 0.33837705]
 [ 0.34082204]
 [ 0.34510171]
 [ 0.34110065]
 [ 0.33965292]
 [ 0.34017582]
 [ 0.33803759]
 [ 0.34386252]
 [ 0.39836198]
 [ 0.34579167]
 [ 0.34445415]
 [ 0.34003075]
 [ 0.338758  ]
 [ 0.35275043]
 [ 0.41558468]
 [ 0.33964649]
 [ 0.33867859]
 [ 0.34779133]
 [ 0.33851099]
 [ 0.3372585 ]
 [ 0.33906894]
 [ 0.34081733]
 [ 0.33802272]
 [ 0.3399453 ]
 [ 0.39445899]
 [ 0.33938278]
 [ 0.33691252]
 [ 0.35067096]
 [ 0.3372585 ]
 [ 0.35013971]
 [ 0.34334411]
 [ 0.3372585 ]
 [ 0.33760512]
 [ 0.35086895]
 [ 0.33805303]
 [ 0.35083011]
 [ 0.33753414]
 [ 0.33936771]
 [ 0.45342772]
 [ 0.40591   ]
 [ 0.33897447]
 [ 0.34015785]
 [ 0.3388087 ]
 [ 0.34280091]
 [ 0.34559019]
 [ 0.33845519]
 [ 0.33928793]
 [ 0.38362829]
 [ 0.33964079]
 [ 0.34015953]
 [ 0.34022316]
 [ 0.35165945]
 [ 0.340486  ]
 [ 0.34005862]
 [ 0.3715087 ]
 [ 0.33925188]
 [ 0.34072039]
 [ 0.37611478]
 [ 0.3372585 ]
 [ 0.34502277]
 [ 0.35618253]
 [ 0.34450415]]
	d = 0 doc_marg=-571.769116721
	d = 1 doc_marg=-456.371086167
	d = 2 doc_marg=-1128.11541862
	d = 3 doc_marg=-417.319814886
	d = 4 doc_marg=-353.482762255
	d = 5 doc_marg=-173.749436795
	d = 6 doc_marg=-546.728775936
	d = 7 doc_marg=-261.095987722
	d = 8 doc_marg=-2011.02139315
	d = 9 doc_marg=-2057.90039444
	d = 10 doc_marg=-838.645070947
	d = 11 doc_marg=-393.86161014
	d = 12 doc_marg=-2932.20383353
	d = 13 doc_marg=-173.287752701
	d = 14 doc_marg=-514.694720971
	d = 15 doc_marg=-1331.72285718
	d = 16 doc_marg=-221.743902582
	d = 17 doc_marg=-1264.10314792
	d = 18 doc_marg=-1049.47756852
	d = 19 doc_marg=-1440.79080984
	d = 20 doc_marg=-355.341959437
	d = 21 doc_marg=-241.385495521
	d = 22 doc_marg=-305.719022206
	d = 23 doc_marg=-1090.10814991
	d = 24 doc_marg=-1179.8791812
	d = 25 doc_marg=-1386.64429211
	d = 26 doc_marg=-1630.23461362
	d = 27 doc_marg=-1315.01112522
	d = 28 doc_marg=-1693.36933509
	d = 29 doc_marg=-1141.19580898
	d = 30 doc_marg=-1105.00223659
	d = 31 doc_marg=-951.371486169
	d = 32 doc_marg=-1247.21223453
	d = 33 doc_marg=-786.282164903
	d = 34 doc_marg=-468.173612529
	d = 35 doc_marg=-661.073448896
	d = 36 doc_marg=-1443.62904675
	d = 37 doc_marg=-1753.19504548
	d = 38 doc_marg=-1031.07773006
	d = 39 doc_marg=-1105.44439687
	d = 40 doc_marg=-1553.62125271
	d = 41 doc_marg=-1302.77766939
	d = 42 doc_marg=-3603.69417664
	d = 43 doc_marg=-1679.67544274
	d = 44 doc_marg=-260.353971347
	d = 45 doc_marg=-1141.93483853
	d = 46 doc_marg=-956.97654948
	d = 47 doc_marg=-1864.10723276
	d = 48 doc_marg=-2185.6468042
	d = 49 doc_marg=-883.090795983
	d = 50 doc_marg=-901.832047687
	d = 51 doc_marg=-1086.49036914
	d = 52 doc_marg=-2380.52304975
	d = 53 doc_marg=-586.889484037
	d = 54 doc_marg=-3674.50288459
	d = 55 doc_marg=-597.353880502
	d = 56 doc_marg=-415.417378413
	d = 57 doc_marg=-1135.98311249
	d = 58 doc_marg=-1848.87674264
	d = 59 doc_marg=-2090.58986252
	d = 60 doc_marg=-3874.85457376
	d = 61 doc_marg=-4672.21843658
	d = 62 doc_marg=-1397.43861639
	d = 63 doc_marg=-813.799054833
	d = 64 doc_marg=-2402.24350271
	d = 65 doc_marg=-1837.44573032
	d = 66 doc_marg=-689.616340078
	d = 67 doc_marg=-1846.62675294
	d = 68 doc_marg=-214.070759894
	d = 69 doc_marg=-311.583906259
	d = 70 doc_marg=-1307.49747727
	d = 71 doc_marg=-2115.18615417
	d = 72 doc_marg=-1022.07519037
	d = 73 doc_marg=-2611.872321
	d = 74 doc_marg=-1043.43681816
	d = 75 doc_marg=-3185.25484996
	d = 76 doc_marg=-892.315630374
	d = 77 doc_marg=-521.979319611
	d = 78 doc_marg=-2085.39248592
	d = 79 doc_marg=-1659.83445224
	d = 80 doc_marg=-706.441273439
	d = 81 doc_marg=-821.608768301
	d = 82 doc_marg=-815.136880935
	d = 83 doc_marg=-967.374715666
	d = 84 doc_marg=-495.274443071
	d = 85 doc_marg=-340.585704966
	d = 86 doc_marg=-497.666053192
	d = 87 doc_marg=-1463.3236231
	d = 88 doc_marg=-187.702228634
	d = 89 doc_marg=-368.345909983
	d = 90 doc_marg=-461.955928701
	d = 91 doc_marg=-1895.03783341
	d = 92 doc_marg=-1986.15655082
	d = 93 doc_marg=-1911.06076428
	d = 94 doc_marg=-5759.91098235
	d = 95 doc_marg=-415.511511463
	d = 96 doc_marg=-1331.67807178
	d = 97 doc_marg=-647.487617161
	d = 98 doc_marg=-2178.88735573
	d = 99 doc_marg=-606.731338883
	d = 100 doc_marg=-1086.73706636
	d = 101 doc_marg=-578.612684489
	d = 102 doc_marg=-586.720546357
	d = 103 doc_marg=-1042.52852608
	d = 104 doc_marg=-1626.25516974
	d = 105 doc_marg=-523.154722345
	d = 106 doc_marg=-561.153416609
	d = 107 doc_marg=-4834.17153302
	d = 108 doc_marg=-523.805044687
	d = 109 doc_marg=-1435.31681495
	d = 110 doc_marg=-1378.96637349
	d = 111 doc_marg=-1144.42807257
	d = 112 doc_marg=-3152.10970457
	d = 113 doc_marg=-778.274096913
	d = 114 doc_marg=-787.582788413
	d = 115 doc_marg=-1776.7838378
	d = 116 doc_marg=-738.894339976
	d = 117 doc_marg=-161.346950705
	d = 118 doc_marg=-263.637190598
	d = 119 doc_marg=-3729.55057635
	d = 120 doc_marg=-725.390870997
	d = 121 doc_marg=-553.675419993
	d = 122 doc_marg=-1637.89313414
	d = 123 doc_marg=-3447.88568037
	d = 124 doc_marg=-1253.19372994
	d = 125 doc_marg=-1093.77515753
	d = 126 doc_marg=-2027.07208298
	d = 127 doc_marg=-1767.83470303
	d = 128 doc_marg=-1777.88419887
	d = 129 doc_marg=-2064.05166992
	d = 130 doc_marg=-4148.5624826
	d = 131 doc_marg=-2035.1307372
	d = 132 doc_marg=-678.422108749
	d = 133 doc_marg=-1433.27539339
	d = 134 doc_marg=-2012.34956198
	d = 135 doc_marg=-826.73937243
	d = 136 doc_marg=-5408.34558385
	d = 137 doc_marg=-1915.71608417
	d = 138 doc_marg=-1287.48404919
	d = 139 doc_marg=-1937.70035133
	d = 140 doc_marg=-311.442196552
	d = 141 doc_marg=-168.813928111
	d = 142 doc_marg=-1812.68525669
	d = 143 doc_marg=-1138.4043164
	d = 144 doc_marg=-638.54280898
	d = 145 doc_marg=-912.983251176
	d = 146 doc_marg=-1198.08016936
	d = 147 doc_marg=-1626.30385676
	d = 148 doc_marg=-812.096054826
	d = 149 doc_marg=-2048.7216601
	d = 150 doc_marg=-2232.63113702
	d = 151 doc_marg=-2343.02864124
	d = 152 doc_marg=-3841.74693486
	d = 153 doc_marg=-702.107286798
	d = 154 doc_marg=-503.592270573
	d = 155 doc_marg=-511.867719792
	d = 156 doc_marg=-266.806601073
	d = 157 doc_marg=-1096.97732113
	d = 158 doc_marg=-1263.38786039
	d = 159 doc_marg=-797.072030986
	d = 160 doc_marg=-1946.38027894
	d = 161 doc_marg=-664.473884028
	d = 162 doc_marg=-1628.41968225
	d = 163 doc_marg=-655.421786388
	d = 164 doc_marg=-1566.58019094
	d = 165 doc_marg=-833.432881604
	d = 166 doc_marg=-1766.3185665
	d = 167 doc_marg=-1598.95882098
	d = 168 doc_marg=-1248.54631121
	d = 169 doc_marg=-1510.26163522
	d = 170 doc_marg=-2062.74427673
	d = 171 doc_marg=-1135.05520236
	d = 172 doc_marg=-377.985266936
	d = 173 doc_marg=-1998.72297862
	d = 174 doc_marg=-1117.33345989
	d = 175 doc_marg=-4300.8826633
	d = 176 doc_marg=-3292.0187304
	d = 177 doc_marg=-262.986483662
	d = 178 doc_marg=-646.304324075
	d = 179 doc_marg=-585.458003672
	d = 180 doc_marg=-580.643322895
	d = 181 doc_marg=-1077.00964348
	d = 182 doc_marg=-2338.61830549
	d = 183 doc_marg=-1205.74599919
	d = 184 doc_marg=-939.727165895
	d = 185 doc_marg=-942.761559705
	d = 186 doc_marg=-864.69816495
	d = 187 doc_marg=-749.403421046
	d = 188 doc_marg=-348.403869601
	d = 189 doc_marg=-1681.64491768
	d = 190 doc_marg=-1665.65614059
	d = 191 doc_marg=-1380.54536987
	d = 192 doc_marg=-1171.95818963
	d = 193 doc_marg=-1918.55340694
	d = 194 doc_marg=-1241.24867774
	d = 195 doc_marg=-1883.6251707
	d = 196 doc_marg=-581.038435302
	d = 197 doc_marg=-832.683832033
	d = 198 doc_marg=-1407.96780364
	d = 199 doc_marg=-1539.29959736
	d = 200 doc_marg=-977.844308576
	d = 201 doc_marg=-1968.26575297
	d = 202 doc_marg=-2646.36806336
	d = 203 doc_marg=-1377.08261141
	d = 204 doc_marg=-662.616425802
	d = 205 doc_marg=-569.704092333
	d = 206 doc_marg=-431.855081404
	d = 207 doc_marg=-1764.42049084
	d = 208 doc_marg=-994.381412936
	d = 209 doc_marg=-857.100550199
	d = 210 doc_marg=-485.961791893
	d = 211 doc_marg=-836.179470168
	d = 212 doc_marg=-4562.63685006
	d = 213 doc_marg=-1921.41187084
Log evidence 2 = -290117.443647
Test perplexity 2 = 36.4372246993

K=400 Training fold=0
K=400 Training fold=1
K=400 Training fold=2
K=400 Testing fold=3
Run training gibbs (642, 1664)
CGS LDA initialising
.................................................................
Using Numba for LDA sampling
Preparing words
Preparing Z matrix
DONE
Sample 1   Log joint likelihood = -2392517.159 
Sample 2   Log joint likelihood = -1520120.639 
Sample 3   Log joint likelihood = -1135743.298 
Sample 4   Log joint likelihood = -1014618.619 
Sample 5   Log joint likelihood = -966014.661 
Sample 6   Log joint likelihood = -937699.470 
Sample 7   Log joint likelihood = -916981.520 
Sample 8   Log joint likelihood = -903446.808 
Sample 9   Log joint likelihood = -894295.103 
Sample 10   Log joint likelihood = -886152.332 
Sample 11   Log joint likelihood = -880451.049 
Sample 12   Log joint likelihood = -875196.312 
Sample 13   Log joint likelihood = -870312.273 
Sample 14   Log joint likelihood = -865645.076 
Sample 15   Log joint likelihood = -861928.558 
Sample 16   Log joint likelihood = -859776.340 
Sample 17   Log joint likelihood = -855951.968 
Sample 18   Log joint likelihood = -853785.159 
Sample 19   Log joint likelihood = -850505.184 
Sample 20   Log joint likelihood = -847618.248 
Sample 21   Log joint likelihood = -845156.877 
Sample 22   Log joint likelihood = -842711.567 
Sample 23   Log joint likelihood = -841595.868 
Sample 24   Log joint likelihood = -840032.661 
Sample 25   Log joint likelihood = -838659.324 
Sample 26   Log joint likelihood = -836806.554 
Sample 27   Log joint likelihood = -835834.025 
Sample 28   Log joint likelihood = -834928.271 
Sample 29   Log joint likelihood = -834610.876 
Sample 30   Log joint likelihood = -833624.229 
Sample 31   Log joint likelihood = -833380.932 
Sample 32   Log joint likelihood = -832609.744 
Sample 33   Log joint likelihood = -831556.352 
Sample 34   Log joint likelihood = -830223.876 
Sample 35   Log joint likelihood = -829830.341 
Sample 36   Log joint likelihood = -828996.387 
Sample 37   Log joint likelihood = -828394.308 
Sample 38   Log joint likelihood = -827330.095 
Sample 39   Log joint likelihood = -827272.166 
Sample 40   Log joint likelihood = -826851.978 
Sample 41   Log joint likelihood = -826715.302 
Sample 42   Log joint likelihood = -825907.011 
Sample 43   Log joint likelihood = -825012.373 
Sample 44   Log joint likelihood = -824481.232 
Sample 45   Log joint likelihood = -824599.993 
Sample 46   Log joint likelihood = -824178.764 
Sample 47   Log joint likelihood = -824179.574 
Sample 48   Log joint likelihood = -824575.048 
Sample 49   Log joint likelihood = -823750.961 
Sample 50   Log joint likelihood = -822280.812 
Run testing importance sampling (214, 1664)
topic_prior = [[ 0.3387391 ]
 [ 0.35063046]
 [ 0.33918068]
 [ 0.34082958]
 [ 0.34194561]
 [ 0.40048077]
 [ 0.34020401]
 [ 0.34011813]
 [ 0.3566852 ]
 [ 0.34092127]
 [ 0.34296922]
 [ 0.35840824]
 [ 0.34303724]
 [ 0.34816217]
 [ 0.33828953]
 [ 0.3413834 ]
 [ 0.34097193]
 [ 0.3422021 ]
 [ 0.3418652 ]
 [ 0.33952071]
 [ 0.33794163]
 [ 0.34041205]
 [ 0.33950005]
 [ 0.34206659]
 [ 0.35753051]
 [ 0.34028425]
 [ 0.39229374]
 [ 0.34340762]
 [ 0.340109  ]
 [ 0.34221648]
 [ 0.35404842]
 [ 0.33934895]
 [ 0.34055501]
 [ 0.3735637 ]
 [ 0.34235127]
 [ 0.33794163]
 [ 0.34041633]
 [ 0.34195712]
 [ 0.33828953]
 [ 0.36599245]
 [ 0.36272854]
 [ 0.33946284]
 [ 0.34079563]
 [ 0.33828953]
 [ 0.3429212 ]
 [ 0.34253717]
 [ 0.33976466]
 [ 0.3463913 ]
 [ 0.34681685]
 [ 0.34063985]
 [ 0.36486491]
 [ 0.34529807]
 [ 0.34565572]
 [ 0.34360852]
 [ 0.33965326]
 [ 0.34550144]
 [ 0.33907994]
 [ 0.3469076 ]
 [ 0.33992286]
 [ 0.33863809]
 [ 0.34392066]
 [ 0.34147437]
 [ 0.34066518]
 [ 0.34333038]
 [ 0.33972911]
 [ 0.33863809]
 [ 0.33992666]
 [ 0.33828953]
 [ 0.34685714]
 [ 0.34356752]
 [ 0.38094092]
 [ 0.34077472]
 [ 0.33794163]
 [ 0.34265916]
 [ 0.34784493]
 [ 0.34145518]
 [ 0.34462269]
 [ 0.33908849]
 [ 0.34123142]
 [ 0.3434891 ]
 [ 0.34513616]
 [ 0.33935531]
 [ 0.34148118]
 [ 0.34024293]
 [ 0.34097638]
 [ 0.33794163]
 [ 0.35181075]
 [ 0.33948692]
 [ 0.35489667]
 [ 0.34004775]
 [ 0.33914988]
 [ 0.34599675]
 [ 0.35101615]
 [ 0.34469002]
 [ 0.36670633]
 [ 0.34312714]
 [ 0.33997055]
 [ 0.33828953]
 [ 0.34403405]
 [ 0.33863809]
 [ 0.34149025]
 [ 0.34058712]
 [ 0.34317454]
 [ 0.34205464]
 [ 0.33922557]
 [ 0.34408328]
 [ 0.34031472]
 [ 0.34343983]
 [ 0.34245027]
 [ 0.34679723]
 [ 0.34941261]
 [ 0.42695376]
 [ 0.33863809]
 [ 0.34269618]
 [ 0.34878882]
 [ 0.3409817 ]
 [ 0.33828953]
 [ 0.34276575]
 [ 0.33933715]
 [ 0.34372342]
 [ 0.34159661]
 [ 0.34237162]
 [ 0.34388857]
 [ 0.34230434]
 [ 0.34166729]
 [ 0.34697074]
 [ 0.34214929]
 [ 0.34457041]
 [ 0.33863809]
 [ 0.34830083]
 [ 0.35806208]
 [ 0.34190703]
 [ 0.34260546]
 [ 0.35951593]
 [ 0.37688384]
 [ 0.34297042]
 [ 0.3435205 ]
 [ 0.34157082]
 [ 0.33938896]
 [ 0.36237481]
 [ 0.33828953]
 [ 0.33839035]
 [ 0.36268386]
 [ 0.34688261]
 [ 0.34145333]
 [ 0.33996692]
 [ 0.34720225]
 [ 0.34106717]
 [ 0.34102641]
 [ 0.34061239]
 [ 0.34758308]
 [ 0.37259948]
 [ 0.33979027]
 [ 0.34104183]
 [ 0.34246684]
 [ 0.34020899]
 [ 0.33828953]
 [ 0.3410234 ]
 [ 0.3410685 ]
 [ 0.34479356]
 [ 0.34096577]
 [ 0.46592846]
 [ 0.34073223]
 [ 0.34329297]
 [ 0.34021681]
 [ 0.34098042]
 [ 0.33828953]
 [ 0.3450818 ]
 [ 0.34035078]
 [ 0.35262158]
 [ 0.33950804]
 [ 0.34270393]
 [ 0.40402909]
 [ 0.34213826]
 [ 0.33916995]
 [ 0.34373453]
 [ 0.33863809]
 [ 0.45557088]
 [ 0.35068689]
 [ 0.33898729]
 [ 0.34272164]
 [ 0.34730652]
 [ 0.34158377]
 [ 0.34098035]
 [ 0.40844403]
 [ 0.3448754 ]
 [ 0.34716538]
 [ 0.34930262]
 [ 0.33828953]
 [ 0.35655431]
 [ 0.34633897]
 [ 0.33863809]
 [ 0.34091409]
 [ 0.34175437]
 [ 0.33794163]
 [ 0.34051872]
 [ 0.35863082]
 [ 0.33988538]
 [ 0.36894552]
 [ 0.34290724]
 [ 0.36426974]
 [ 0.34084992]
 [ 0.34021205]
 [ 0.34085122]
 [ 0.34537728]
 [ 0.34064506]
 [ 0.34443094]
 [ 0.33794163]
 [ 0.33946017]
 [ 0.34072451]
 [ 0.34446979]
 [ 0.33946573]
 [ 0.34369964]
 [ 0.34014061]
 [ 0.3450041 ]
 [ 0.34067759]
 [ 0.34149436]
 [ 0.34037875]
 [ 0.33972638]
 [ 0.34181897]
 [ 0.34077384]
 [ 0.35356853]
 [ 0.34634021]
 [ 0.34499972]
 [ 0.34447334]
 [ 0.3428166 ]
 [ 0.34464495]
 [ 0.35042319]
 [ 0.34818798]
 [ 0.34344034]
 [ 0.34331009]
 [ 0.34364617]
 [ 0.34566862]
 [ 0.33970742]
 [ 0.34480553]
 [ 0.33982254]
 [ 0.33863809]
 [ 0.38459753]
 [ 0.33863809]
 [ 0.3923182 ]
 [ 0.3445386 ]
 [ 0.3513059 ]
 [ 0.34342843]
 [ 0.3414602 ]
 [ 0.33828953]
 [ 0.34091548]
 [ 0.34375532]
 [ 0.34048318]
 [ 0.34898856]
 [ 0.33998456]
 [ 0.34146658]
 [ 0.34173167]
 [ 0.34431751]
 [ 0.36248378]
 [ 0.34278908]
 [ 0.34443447]
 [ 0.34326545]
 [ 0.36676788]
 [ 0.33828953]
 [ 0.34359193]
 [ 0.35206147]
 [ 0.34228854]
 [ 0.34212405]
 [ 0.34932572]
 [ 0.34012189]
 [ 0.34123532]
 [ 0.35307775]
 [ 0.34091869]
 [ 0.33902586]
 [ 0.34047171]
 [ 0.3437968 ]
 [ 0.33863809]
 [ 0.34373624]
 [ 0.33863809]
 [ 0.34939355]
 [ 0.34183571]
 [ 0.34166483]
 [ 0.34384897]
 [ 0.34601257]
 [ 0.34017725]
 [ 0.34331154]
 [ 0.34467724]
 [ 0.33953551]
 [ 0.34244809]
 [ 0.34925216]
 [ 0.34101046]
 [ 0.40097721]
 [ 0.34319074]
 [ 0.4535639 ]
 [ 0.35855327]
 [ 0.33863809]
 [ 0.36562981]
 [ 0.34044452]
 [ 0.34066324]
 [ 0.34440972]
 [ 0.34127037]
 [ 0.33944667]
 [ 0.34960395]
 [ 0.36337148]
 [ 0.38138528]
 [ 0.33839035]
 [ 0.34035501]
 [ 0.3424769 ]
 [ 0.34273262]
 [ 0.34385644]
 [ 0.3405052 ]
 [ 0.33959705]
 [ 0.34073648]
 [ 0.34188475]
 [ 0.34328749]
 [ 0.34002041]
 [ 0.34059065]
 [ 0.34393377]
 [ 0.34554842]
 [ 0.3387391 ]
 [ 0.34095749]
 [ 0.3413685 ]
 [ 0.34073683]
 [ 0.34055906]
 [ 0.33794163]
 [ 0.35443343]
 [ 0.33900227]
 [ 0.3407713 ]
 [ 0.33916995]
 [ 0.34325147]
 [ 0.34239558]
 [ 0.34156881]
 [ 0.36456247]
 [ 0.33828953]
 [ 0.33828953]
 [ 0.33794163]
 [ 0.33905689]
 [ 0.34191775]
 [ 0.34260353]
 [ 0.33828953]
 [ 0.40277715]
 [ 0.34332939]
 [ 0.33794163]
 [ 0.34204955]
 [ 0.35075534]
 [ 0.40901733]
 [ 0.34039429]
 [ 0.33794163]
 [ 0.33945854]
 [ 0.33863809]
 [ 0.33863809]
 [ 0.34209809]
 [ 0.34733849]
 [ 0.35221455]
 [ 0.37655296]
 [ 0.33898729]
 [ 0.34062666]
 [ 0.34570628]
 [ 0.34214397]
 [ 0.34652371]
 [ 0.34134447]
 [ 0.34495147]
 [ 0.34659325]
 [ 0.38517843]
 [ 0.33828953]
 [ 0.3412805 ]
 [ 0.34284856]
 [ 0.34489771]
 [ 0.33963431]
 [ 0.3422246 ]
 [ 0.34102183]
 [ 0.43991861]
 [ 0.34168298]
 [ 0.34135366]
 [ 0.34225435]
 [ 0.33828953]
 [ 0.34066006]
 [ 0.34181559]
 [ 0.35092911]
 [ 0.34162564]
 [ 0.34057386]
 [ 0.34078081]
 [ 0.34006305]
 [ 0.34404967]
 [ 0.33971935]
 [ 0.34200901]
 [ 0.34082544]
 [ 0.34139862]
 [ 0.34157495]
 [ 0.3405269 ]
 [ 0.34554547]
 [ 0.35141703]
 [ 0.34080196]
 [ 0.34325141]
 [ 0.34760363]
 [ 0.33912908]
 [ 0.33898729]
 [ 0.33898729]
 [ 0.34289156]
 [ 0.35210989]
 [ 0.34172992]
 [ 0.34402618]
 [ 0.34312618]
 [ 0.33828953]
 [ 0.345222  ]]
	d = 0 doc_marg=-454.798202776
	d = 1 doc_marg=-795.519693168
	d = 2 doc_marg=-2004.89608337
	d = 3 doc_marg=-533.78497009
	d = 4 doc_marg=-360.736608473
	d = 5 doc_marg=-184.649126635
	d = 6 doc_marg=-593.98902793
	d = 7 doc_marg=-328.246075244
	d = 8 doc_marg=-1289.99315298
	d = 9 doc_marg=-2014.7579355
	d = 10 doc_marg=-805.46143984
	d = 11 doc_marg=-397.425909621
	d = 12 doc_marg=-2954.23745444
	d = 13 doc_marg=-180.747143283
	d = 14 doc_marg=-508.243959366
	d = 15 doc_marg=-1321.31789582
	d = 16 doc_marg=-692.363104045
	d = 17 doc_marg=-1240.62283893
	d = 18 doc_marg=-1409.37496436
	d = 19 doc_marg=-1369.12845545
	d = 20 doc_marg=-361.718983686
	d = 21 doc_marg=-245.269244081
	d = 22 doc_marg=-503.730136512
	d = 23 doc_marg=-1045.24499875
	d = 24 doc_marg=-1262.12035339
	d = 25 doc_marg=-1392.84520135
	d = 26 doc_marg=-2811.40975941
	d = 27 doc_marg=-1170.87959154
	d = 28 doc_marg=-2439.79605276
	d = 29 doc_marg=-1195.88317335
	d = 30 doc_marg=-908.502372604
	d = 31 doc_marg=-1148.21379775
	d = 32 doc_marg=-1093.17404822
	d = 33 doc_marg=-834.242636443
	d = 34 doc_marg=-482.701179054
	d = 35 doc_marg=-523.685482228
	d = 36 doc_marg=-766.774081556
	d = 37 doc_marg=-2843.87022575
	d = 38 doc_marg=-1010.42558484
	d = 39 doc_marg=-1035.53306325
	d = 40 doc_marg=-1695.84277734
	d = 41 doc_marg=-1832.8739257
	d = 42 doc_marg=-2807.25477578
	d = 43 doc_marg=-1553.16675755
	d = 44 doc_marg=-314.90844824
	d = 45 doc_marg=-1248.15656335
	d = 46 doc_marg=-1074.64410229
	d = 47 doc_marg=-1838.95960736
	d = 48 doc_marg=-2257.42274633
	d = 49 doc_marg=-886.344124516
	d = 50 doc_marg=-905.743796451
	d = 51 doc_marg=-964.941736336
	d = 52 doc_marg=-2464.53927695
	d = 53 doc_marg=-712.283777729
	d = 54 doc_marg=-2592.07179755
	d = 55 doc_marg=-587.473625882
	d = 56 doc_marg=-440.480958276
	d = 57 doc_marg=-537.982389626
	d = 58 doc_marg=-1886.38078963
	d = 59 doc_marg=-1898.65459755
	d = 60 doc_marg=-1932.31719903
	d = 61 doc_marg=-4030.02993771
	d = 62 doc_marg=-815.77876049
	d = 63 doc_marg=-822.063775629
	d = 64 doc_marg=-2893.73265969
	d = 65 doc_marg=-1882.98423003
	d = 66 doc_marg=-671.994234297
	d = 67 doc_marg=-1618.64904451
	d = 68 doc_marg=-297.983051648
	d = 69 doc_marg=-329.953492819
	d = 70 doc_marg=-1304.97573145
	d = 71 doc_marg=-2196.6597865
	d = 72 doc_marg=-986.347964218
	d = 73 doc_marg=-2643.05134484
	d = 74 doc_marg=-2186.51526322
	d = 75 doc_marg=-4531.53126935
	d = 76 doc_marg=-884.929416781
	d = 77 doc_marg=-538.933218575
	d = 78 doc_marg=-3077.33012265
	d = 79 doc_marg=-697.897485127
	d = 80 doc_marg=-683.627842742
	d = 81 doc_marg=-818.358167302
	d = 82 doc_marg=-868.726151177
	d = 83 doc_marg=-919.154904036
	d = 84 doc_marg=-490.631537252
	d = 85 doc_marg=-359.886815775
	d = 86 doc_marg=-513.942881537
	d = 87 doc_marg=-2264.04291175
	d = 88 doc_marg=-175.058133057
	d = 89 doc_marg=-370.480340651
	d = 90 doc_marg=-444.199103221
	d = 91 doc_marg=-1392.46483824
	d = 92 doc_marg=-2311.70819382
	d = 93 doc_marg=-1004.30533799
	d = 94 doc_marg=-7575.26084328
	d = 95 doc_marg=-412.097744973
	d = 96 doc_marg=-1311.48222134
	d = 97 doc_marg=-678.434268833
	d = 98 doc_marg=-2344.37140294
	d = 99 doc_marg=-581.543165718
	d = 100 doc_marg=-1158.17923933
	d = 101 doc_marg=-570.47573499
	d = 102 doc_marg=-573.336488148
	d = 103 doc_marg=-1069.28193933
	d = 104 doc_marg=-2522.00872179
	d = 105 doc_marg=-534.297019174
	d = 106 doc_marg=-542.242710194
	d = 107 doc_marg=-3418.28598852
	d = 108 doc_marg=-539.950026386
	d = 109 doc_marg=-2037.33084455
	d = 110 doc_marg=-1391.94968686
	d = 111 doc_marg=-1057.90494994
	d = 112 doc_marg=-3066.59683165
	d = 113 doc_marg=-1388.35233488
	d = 114 doc_marg=-778.89111916
	d = 115 doc_marg=-1537.58033742
	d = 116 doc_marg=-676.070715751
	d = 117 doc_marg=-163.830854776
	d = 118 doc_marg=-268.758326152
	d = 119 doc_marg=-4791.77900996
	d = 120 doc_marg=-748.134252472
	d = 121 doc_marg=-521.775158196
	d = 122 doc_marg=-1513.50924893
	d = 123 doc_marg=-3417.10431322
	d = 124 doc_marg=-1249.74264017
	d = 125 doc_marg=-1049.81141435
	d = 126 doc_marg=-1289.83173815
	d = 127 doc_marg=-1458.5905951
	d = 128 doc_marg=-1494.67498815
	d = 129 doc_marg=-2478.31310685
	d = 130 doc_marg=-4056.11809198
	d = 131 doc_marg=-1972.29963453
	d = 132 doc_marg=-891.585120095
	d = 133 doc_marg=-1542.71227654
	d = 134 doc_marg=-3179.47987737
	d = 135 doc_marg=-816.689816779
	d = 136 doc_marg=-4004.90574828
	d = 137 doc_marg=-3361.68297666
	d = 138 doc_marg=-1255.06302022
	d = 139 doc_marg=-1988.68575597
	d = 140 doc_marg=-830.942534806
	d = 141 doc_marg=-173.655079787
	d = 142 doc_marg=-917.825196492
	d = 143 doc_marg=-1138.30786758
	d = 144 doc_marg=-640.45480693
	d = 145 doc_marg=-805.22995553
	d = 146 doc_marg=-1309.01929982
	d = 147 doc_marg=-2096.17693312
	d = 148 doc_marg=-829.964074502
	d = 149 doc_marg=-2060.66021573
	d = 150 doc_marg=-2400.33938116
	d = 151 doc_marg=-2903.86344623
	d = 152 doc_marg=-3849.99579625
	d = 153 doc_marg=-626.550486431
	d = 154 doc_marg=-493.917742185
	d = 155 doc_marg=-473.758540335
	d = 156 doc_marg=-264.156354895
	d = 157 doc_marg=-1999.62569706
	d = 158 doc_marg=-685.044083498
	d = 159 doc_marg=-777.918453601
	d = 160 doc_marg=-1808.39083475
	d = 161 doc_marg=-665.736568175
	d = 162 doc_marg=-1604.96927205
	d = 163 doc_marg=-600.005261499
	d = 164 doc_marg=-1672.40636746
	d = 165 doc_marg=-832.584418394
	d = 166 doc_marg=-1027.16588903
	d = 167 doc_marg=-1575.16552412
	d = 168 doc_marg=-1161.93746337
	d = 169 doc_marg=-1412.04777309
	d = 170 doc_marg=-2209.78352478
	d = 171 doc_marg=-1199.35449071
	d = 172 doc_marg=-409.639114541
	d = 173 doc_marg=-1729.87243036
	d = 174 doc_marg=-1252.79374148
	d = 175 doc_marg=-5528.14436023
	d = 176 doc_marg=-3872.56058233
	d = 177 doc_marg=-275.037866055
	d = 178 doc_marg=-718.246764634
	d = 179 doc_marg=-587.298547038
	d = 180 doc_marg=-581.804943438
	d = 181 doc_marg=-1039.5232112
	d = 182 doc_marg=-2178.83168586
	d = 183 doc_marg=-1084.10869018
	d = 184 doc_marg=-997.870538187
	d = 185 doc_marg=-984.578558015
	d = 186 doc_marg=-921.583943565
	d = 187 doc_marg=-668.789062384
	d = 188 doc_marg=-344.506418494
	d = 189 doc_marg=-1366.22449609
	d = 190 doc_marg=-1022.37808988
	d = 191 doc_marg=-1454.22455091
	d = 192 doc_marg=-1212.29418061
	d = 193 doc_marg=-1921.56601342
	d = 194 doc_marg=-1101.303938
	d = 195 doc_marg=-1714.79201928
	d = 196 doc_marg=-600.043907789
	d = 197 doc_marg=-325.288072014
	d = 198 doc_marg=-535.85151747
	d = 199 doc_marg=-1500.28808704
	d = 200 doc_marg=-974.274565501
	d = 201 doc_marg=-2557.67334289
	d = 202 doc_marg=-2736.96491952
	d = 203 doc_marg=-1248.72553044
	d = 204 doc_marg=-725.196306519
	d = 205 doc_marg=-576.35446104
	d = 206 doc_marg=-453.984119606
	d = 207 doc_marg=-1455.38916464
	d = 208 doc_marg=-972.625706624
	d = 209 doc_marg=-867.730613744
	d = 210 doc_marg=-546.430000335
	d = 211 doc_marg=-890.913330549
	d = 212 doc_marg=-2939.84849524
	d = 213 doc_marg=-1724.96347522
Log evidence 3 = -292905.160725
Test perplexity 3 = 37.7181222789


Cross-validation done!
K=400,mean_approximate_log_evidence=-292905.160725,mean_perplexity=35.5470483347
